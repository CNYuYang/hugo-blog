<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>
        BusTubä¸­ä½¿ç”¨çš„ä¸‰æ–¹ä»¶-linenoise ::
        ä½™ä¸ºæ°‘åŒå¿—|åšä¸€ä¸ªä¼˜ç§€çš„æ™®é€šäººï¼Œåœ¨çƒ­çˆ±ä¸­ç‡ƒçƒ§ï¼
      </title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="Linenoiseæ˜¯å¯ä»¥å®Œå…¨ä»£æ›¿readlineçš„ï¼Œéå¸¸è½»é‡çº§çš„å‘½ä»¤è¡Œå¤„ç†å·¥å…·ã€‚Redisï¼ŒMongoDBå’ŒAndroidéƒ½å°†Linenoiseä½œä¸ºå‘½ä»¤è¡Œè§£æå·¥å…·ã€‚ ğŸ”—é¡¹ç›®åœ°å€ï¼šhttps://github.com/antirez/linenoise å…¥æ‰‹ # ä¸€ä¸‹å°±æ˜¯ä¸€ä¸ªç®€å•çš„å…¥é—¨ç¨‹åºï¼š #include &amp;lt;cstdio&amp;gt; #include &amp;lt;cstdlib&amp;gt; #include &amp;#34;linenoise/linenoise.h&amp;#34; int main() {"
/>
<meta
  name="keywords"
  content=""
/>
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://yuyang.run/posts/cmu15-445%E5%AE%9E%E9%AA%8C/bustub%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%9A%84%E4%B8%89%E6%96%B9%E4%BB%B6-linenoise/" />







<link rel="stylesheet" href="/css/style.css" />

<link rel="stylesheet" href="https://yuyang.run/style.css" />


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://yuyang.run/img/apple-touch-icon-144-precomposed.png" />
<link rel="shortcut icon" href="https://yuyang.run/img/favicon.png" />




<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="BusTubä¸­ä½¿ç”¨çš„ä¸‰æ–¹ä»¶-linenoise"/>
<meta name="twitter:description" content="Linenoiseæ˜¯å¯ä»¥å®Œå…¨ä»£æ›¿readlineçš„ï¼Œéå¸¸è½»é‡çº§çš„å‘½ä»¤è¡Œå¤„ç†å·¥å…·ã€‚Redisï¼ŒMongoDBå’ŒAndroidéƒ½å°†Linenoiseä½œä¸ºå‘½ä»¤è¡Œè§£æå·¥å…·ã€‚ ğŸ”—é¡¹ç›®åœ°å€ï¼šhttps://github.com/antirez/linenoise å…¥æ‰‹ # ä¸€ä¸‹å°±æ˜¯ä¸€ä¸ªç®€å•çš„å…¥é—¨ç¨‹åºï¼š #include &lt;cstdio&gt; #include &lt;cstdlib&gt; #include &#34;linenoise/linenoise.h&#34; int main() {"/>



<meta property="og:title" content="BusTubä¸­ä½¿ç”¨çš„ä¸‰æ–¹ä»¶-linenoise" />
<meta property="og:description" content="Linenoiseæ˜¯å¯ä»¥å®Œå…¨ä»£æ›¿readlineçš„ï¼Œéå¸¸è½»é‡çº§çš„å‘½ä»¤è¡Œå¤„ç†å·¥å…·ã€‚Redisï¼ŒMongoDBå’ŒAndroidéƒ½å°†Linenoiseä½œä¸ºå‘½ä»¤è¡Œè§£æå·¥å…·ã€‚ ğŸ”—é¡¹ç›®åœ°å€ï¼šhttps://github.com/antirez/linenoise å…¥æ‰‹ # ä¸€ä¸‹å°±æ˜¯ä¸€ä¸ªç®€å•çš„å…¥é—¨ç¨‹åºï¼š #include &lt;cstdio&gt; #include &lt;cstdlib&gt; #include &#34;linenoise/linenoise.h&#34; int main() {" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yuyang.run/posts/cmu15-445%E5%AE%9E%E9%AA%8C/bustub%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%9A%84%E4%B8%89%E6%96%B9%E4%BB%B6-linenoise/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-17T16:13:11+08:00" />
<meta property="article:modified_time" content="2024-01-17T16:13:11+08:00" />








  </head>
  <body class="light-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a
  href="https://yuyang.run"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >ä½™ä¸ºæ°‘åŒå¿—</span
    >
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/posts/">æ–‡ç« </a></li>
        
      
        
          <li><a href="/tags/">æ ‡ç­¾</a></li>
        
      
        
          <li><a href="/categories/">åˆ†ç±»</a></li>
        
      
        
          <li><a href="https://geekbang.yuyang.run">æå®¢å¸®</a></li>
        
      
        
          <li><a href="/about/">å…³äºæˆ‘</a></li>
        
      
      
      
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/posts/">æ–‡ç« </a></li>
      
    
      
        <li><a href="/tags/">æ ‡ç­¾</a></li>
      
    
      
        <li><a href="/categories/">åˆ†ç±»</a></li>
      
    
      
        <li><a href="https://geekbang.yuyang.run">æå®¢å¸®</a></li>
      
    
      
        <li><a href="/about/">å…³äºæˆ‘</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none" />
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg
  class="theme-toggler"
  width="24"
  height="24"
  viewBox="0 0 48 48"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"
  />
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <article class="post">
    
    
        <div style="position: fixed; right:10px; overflow:auto; top: 100px; width: 22%; bottom:50px">
          <h2>ç›®å½•</h2>
          <aside class="table-of-contents"><nav id="TableOfContents">
  <ul>
    <li><a href="#å…¥æ‰‹">å…¥æ‰‹</a></li>
    <li><a href="#å½©è‰²æç¤ºç¬¦">å½©è‰²æç¤ºç¬¦</a>
      <ul>
        <li><a href="#paramå¯é€‰é…ç½®">Paramå¯é€‰é…ç½®</a></li>
        <li><a href="#linenoiseä¸­ä½¿ç”¨">linenoiseä¸­ä½¿ç”¨</a></li>
      </ul>
    </li>
    <li><a href="#è‡ªåŠ¨è¡¥å…¨">è‡ªåŠ¨è¡¥å…¨</a></li>
    <li><a href="#å‘½ä»¤æç¤º">å‘½ä»¤æç¤º</a></li>
    <li><a href="#æ¸…å±">æ¸…å±</a></li>
    <li><a href="#å•è¡Œorå¤šè¡Œç¼–è¾‘">å•è¡Œorå¤šè¡Œç¼–è¾‘</a></li>
    <li><a href="#å‘½ä»¤å†å²">å‘½ä»¤å†å²</a></li>
    <li><a href="#bustubä¸­çš„ä½¿ç”¨">BusTubä¸­çš„ä½¿ç”¨</a></li>
  </ul>
</nav></aside>
        </div>
      
    
    <div class="in-article">
      
        <figure class="post-cover">
  
    <img src="https://yuyang.run/cover/database.png" alt="BusTubä¸­ä½¿ç”¨çš„ä¸‰æ–¹ä»¶-linenoise"/>
  

  
</figure>

      
    </div>
    <h1 class="post-title">BusTubä¸­ä½¿ç”¨çš„ä¸‰æ–¹ä»¶-linenoise</h1>
    <div class="post-meta">
      
        <time class="post-date">
          2024-01-17 16:13:11
        </time>

        
          
        
      

      


      
    </div>

    
      <span class="post-tags">
        
          <a href="https://yuyang.run/tags/cmu15-445/">#CMU15-445</a>&nbsp;
        
          <a href="https://yuyang.run/tags/sql/">#SQL</a>&nbsp;
        
      </span>
    

    <div class="post-content">

      <p>Linenoiseæ˜¯å¯ä»¥å®Œå…¨ä»£æ›¿readlineçš„ï¼Œéå¸¸è½»é‡çº§çš„å‘½ä»¤è¡Œå¤„ç†å·¥å…·ã€‚Redisï¼ŒMongoDBå’ŒAndroidéƒ½å°†Linenoiseä½œä¸ºå‘½ä»¤è¡Œè§£æå·¥å…·ã€‚</p>
<p>ğŸ”—é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/antirez/linenoise" target="_blank">https://github.com/antirez/linenoise</a>
</p>
<h2 id="å…¥æ‰‹">
  å…¥æ‰‹
  <a href="#%e5%85%a5%e6%89%8b" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>ä¸€ä¸‹å°±æ˜¯ä¸€ä¸ªç®€å•çš„å…¥é—¨ç¨‹åºï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;cstdio&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;cstdlib&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;linenoise/linenoise.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>line <span style="color:#f92672">=</span> NULL;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> ((line <span style="color:#f92672">=</span> linenoise(<span style="color:#e6db74">&#34;hello&gt; &#34;</span>)) <span style="color:#f92672">!=</span> NULL) {
</span></span><span style="display:flex;"><span>        printf(<span style="color:#e6db74">&#34;Your wrote: %s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, line);
</span></span><span style="display:flex;"><span>        free(line);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><blockquote>
<p>ä¸è¿‡Clionä¸æ”¯æŒç›´æ¥è¿è¡Œï¼Œå¾—ä½¿ç”¨cmakeç¼–è¯‘å‡ºäºŒè¿›åˆ¶æ–‡ä»¶åè¿è¡Œã€‚åŸå› åº”è¯¥æ˜¯Clionæ”¯æŒçš„æ˜¯readlineåè®®ã€‚</p>
</blockquote>
<p>æ•ˆæœï¼š</p>
<p><img src="/images/15445/lab0-00.png" alt=""></p>
<h2 id="å½©è‰²æç¤ºç¬¦">
  å½©è‰²æç¤ºç¬¦
  <a href="#%e5%bd%a9%e8%89%b2%e6%8f%90%e7%a4%ba%e7%ac%a6" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>è½¬ä¹‰åºåˆ—ä»¥æ§åˆ¶å­—<code>ESC</code>å¼€å¤´ï¼Œè¯¥å­—ç¬¦çš„ASCIIç åè¿›åˆ¶è¡¨ç¤ºä¸º27ï¼Œåå…­è¿›åˆ¶ä¸º0x1Bï¼Œå…«è¿›åˆ¶è¡¨ç¤ºä¸º033ï¼Œå¤šæ•°çš„è½¬ä¹‰åºåˆ—è¶…è¿‡ä¸¤ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥é€šå¸¸ä»¥<code>ESC</code>å’Œå·¦æ‹¬å·<code>[</code>å¼€å¤´ã€‚è¯¥èµ·å§‹åºåˆ—ç§°ä¸ºæ§åˆ¶åºåˆ—å¼•å¯¼ç¬¦ï¼ˆCSI,Control Sequence Introï¼‰ï¼Œé€šå¸¸ç”±<code>\033[</code>æˆ–è€…<code>\e[</code>ä»£æ›¿ã€‚</p>
<p>é€šè¿‡è½¬ä¹‰åºåˆ—è®¾ç½®ç»ˆç«¯æ˜¾ç¤ºå±æ€§æ—¶ï¼Œå¯ä»¥é‡‡ç”¨ä¸‹åˆ—æ ¼å¼ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>\033[ Param {;Param;...} m
</span></span><span style="display:flex;"><span>æˆ–è€…
</span></span><span style="display:flex;"><span>\e[ Param {;Param;...}m
</span></span></code></pre></div><p>å…¶ä¸­ï¼Œ<code>\033[</code>æˆ–è€…<code>\e[</code>å¼•å¯¼è½¬ä¹‰åºåˆ—ï¼Œ<code>m</code>è¡¨ç¤ºè®¾ç½®å±æ€§å¹¶ç»“æŸè½¬ä¹‰ã€‚<code>Param</code>ä¸ºå±æ€§å€¼ï¼Œ<code>{...}</code>è¡¨ç¤ºå‚æ•°æ˜¯å¯ä»¥å¤šé€‰çš„ï¼Œå¤šä¸ªå‚æ•°ä¹‹é—´ç”¨åˆ†å·éš”å¼€ï¼Œä¸é™åˆ¶é¡ºåºã€‚</p>
<h3 id="paramå¯é€‰é…ç½®">
  Paramå¯é€‰é…ç½®
  <a href="#param%e5%8f%af%e9%80%89%e9%85%8d%e7%bd%ae" class="h-anchor" aria-hidden="true">#</a>
</h3>
<p><strong>æ˜¾ç¤ºæ–¹å¼</strong></p>
<p>0ï¼šé»˜è®¤å€¼</p>
<p>1ï¼šç²—ä½“/é«˜äº®</p>
<p>2ï¼šè®¾ç½®ä¸€åŠäº®åº¦</p>
<p>4ï¼šä¸‹åˆ’çº¿</p>
<p>5ï¼šé—ªçƒ</p>
<p>7ï¼šåæ˜¾ã€ç¿»è½¬å‰æ™¯è‰²å’ŒèƒŒæ™¯è‰²</p>
<p>22ï¼šéç²—ä½“</p>
<p>24ï¼šæ— ä¸‹æ»‘çº¿</p>
<p>25ï¼šæ— é—ªçƒ</p>
<p>27ï¼šå…³é—­åæ˜¾</p>
<p><strong>å‰æ™¯è‰²ï¼ˆå­—ä½“é¢œè‰²ï¼‰</strong></p>
<p>30ï¼šé»‘è‰²å‰æ™¯è‰²</p>
<p>31ï¼šçº¢è‰²å‰æ™¯è‰²</p>
<p>32ï¼šç»¿è‰²å‰æ™¯è‰²</p>
<p>33ï¼šé»„è‰²å‰æ™¯è‰²</p>
<p>34ï¼šè“è‰²å‰æ™¯è‰²</p>
<p>35ï¼šç´«è‰²å‰æ™¯è‰²</p>
<p>36ï¼šç²‰è‰²å‰æ™¯è‰²</p>
<p>37ï¼šç™½è‰²å‰æ™¯è‰²</p>
<p><strong>èƒŒæ™¯è‰²</strong></p>
<p>40ï¼šé»‘è‰²èƒŒæ™¯è‰²</p>
<p>41ï¼šçº¢è‰²èƒŒæ™¯è‰²</p>
<p>42ï¼šç»¿è‰²èƒŒæ™¯è‰²</p>
<p>43ï¼šé»„è‰²èƒŒæ™¯è‰²</p>
<p>44ï¼šè“è‰²èƒŒæ™¯è‰²</p>
<p>45ï¼šç´«è‰²èƒŒæ™¯è‰²</p>
<p>46ï¼šç²‰è‰²èƒŒæ™¯è‰²</p>
<p>47ï¼šç™½è‰²èƒŒæ™¯è‰²</p>
<h3 id="linenoiseä¸­ä½¿ç”¨">
  linenoiseä¸­ä½¿ç”¨
  <a href="#linenoise%e4%b8%ad%e4%bd%bf%e7%94%a8" class="h-anchor" aria-hidden="true">#</a>
</h3>
<p>åœ¨æç¤ºç¬¦å‰ååŠ ä¸Šï¼Œä¿®æ”¹å‘½ä»¤(<code>GREEN</code>ï¼Œ<strong>åŠ ç²—ç»¿è‰²å­—ä½“</strong>)ä¸æ¸…ç©ºæ ·å¼å‘½ä»¤(<code>NONE</code>)ï¼š</p>
<p><img src="/images/15445/lab0-01.png" alt=""></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;cstdio&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;cstdlib&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;linenoise/linenoise.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define NONE &#34;\033[m&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define GREEN &#34;\033[1;32m&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span><span style="color:#f92672">*</span> line <span style="color:#f92672">=</span> NULL;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> ((line <span style="color:#f92672">=</span> linenoise(GREEN<span style="color:#e6db74">&#34;hello&gt; &#34;</span> NONE)) <span style="color:#f92672">!=</span> NULL)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        printf(<span style="color:#e6db74">&#34;Your wrote: %s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, line);
</span></span><span style="display:flex;"><span>        free(line);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>æ•ˆæœï¼š</p>
<p><img src="/images/15445/lab0-02.png" alt=""></p>
<h2 id="è‡ªåŠ¨è¡¥å…¨">
  è‡ªåŠ¨è¡¥å…¨
  <a href="#%e8%87%aa%e5%8a%a8%e8%a1%a5%e5%85%a8" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>Linenoiseæ”¯æŒè‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ï¼Œå³ç”¨æˆ·æŒ‰ä¸‹<code>&lt;TAB&gt;</code>é”®æ—¶ä¼šè‡ªåŠ¨è¡¥å…¨ä½ çš„å‘½ä»¤ã€‚</p>
<p>ä¸ºäº†å®ç°è¿™ä¸€åŠŸèƒ½ï¼Œä½ å¯ä»¥æ³¨å†Œå¹¶å®ç°ä½ çš„è¡¥å…¨å‡½æ•°ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">// æ³¨å†Œè‡ªåŠ¨è¡¥å…¨å‡½æ•°completion
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>linenoiseSetCompletionCallback(completion);
</span></span></code></pre></div><p>æ³¨å†Œçš„è¡¥å…¨å¿…é¡»æ˜¯ä¸€ä¸ªvoidè¿”å›å€¼å‡½æ•°ï¼Œéœ€è¦ä¼ å…¥ä¸€ä¸ªconst charæŒ‡é’ˆï¼ˆè¯¥æŒ‡é’ˆæ˜¯ç”¨æˆ·åˆ°ç›®å‰ä¸ºæ­¢å·²é”®å…¥çš„å‘½ä»¤å­—ç¬¦ï¼‰å’Œä¸€ä¸ªlinenoiseCompletionså¯¹è±¡æŒ‡é’ˆï¼Œè¯¥å¯¹è±¡æŒ‡é’ˆç”¨ä½œæ˜¯linenoiseAddCompletionå°†å›è°ƒæ·»åŠ åˆ°è¡¥å…¨ä¸­çš„å‚æ•°ã€‚ä¸€ä¸ªä¾‹å­å°†ä½¿å…¶æ›´åŠ æ¸…æ¥šï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">completion</span>(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>buf, linenoiseCompletions <span style="color:#f92672">*</span>lc) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (buf[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;h&#39;</span>) {
</span></span><span style="display:flex;"><span>        linenoiseAddCompletion(lc,<span style="color:#e6db74">&#34;hello&#34;</span>);
</span></span><span style="display:flex;"><span>        linenoiseAddCompletion(lc,<span style="color:#e6db74">&#34;hello there&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ç”¨æˆ·è¾“å…¥&rsquo;h&rsquo;æ˜¯ä¼šç°å®è¡¥å…¨åˆ—è¡¨&quot;hello&quot;ï¼Œåœ¨æŒ‰ä¸€æ¬¡tabåˆ™ä¼šè¡¥å…¨è‡³&quot;hello there&quot;ã€‚</p>
<h2 id="å‘½ä»¤æç¤º">
  å‘½ä»¤æç¤º
  <a href="#%e5%91%bd%e4%bb%a4%e6%8f%90%e7%a4%ba" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>Linenoiseå…·æœ‰ç§°ä¸ºæç¤ºçš„åŠŸèƒ½ï¼Œå½“ä½ ä½¿ç”¨Linenoiseå®ç°REPLæ—¶ï¼Œè¿™ä¸ªåŠŸèƒ½éå¸¸æœ‰ç”¨ã€‚å½“ç”¨æˆ·é”®å…¥æ—¶ï¼Œè¯¥åŠŸèƒ½ä¼šåœ¨å…‰æ ‡çš„å³ä¾§æ˜¾ç¤ºå¯èƒ½æœ‰ç”¨çš„æç¤ºã€‚æç¤ºå¯ä»¥ä½¿ç”¨ä¸ç”¨æˆ·é”®å…¥çš„é¢œè‰²ä¸åŒçš„é¢œè‰²æ˜¾ç¤ºï¼Œä¹Ÿå¯ä»¥åŠ ç²—ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå½“ç”¨æˆ·å¼€å§‹è¾“å…¥&quot;git remote add&quot;æç¤ºæ—¶ï¼Œå¯ä»¥åœ¨æç¤ºçš„å³ä¾§æ˜¾ç¤ºå­—ç¬¦ä¸²<code>&lt;name&gt; &lt;url&gt;</code>ã€‚</p>
<p>æ”¹æ¥å£ä¸è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ç±»ä¼¼ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>linenoiseSetHintsCallback(hints);
</span></span></code></pre></div><p>å›è°ƒå‡½æ•°å®ç°å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">hints</span>(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>buf, <span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>color, <span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>bold) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>strcasecmp(buf,<span style="color:#e6db74">&#34;git remote add&#34;</span>)) {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">*</span>color <span style="color:#f92672">=</span> <span style="color:#ae81ff">35</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">*</span>bold <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34; &lt;name&gt; &lt;url&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> NULL;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>æ•ˆæœï¼š</p>
<p><img src="/images/15445/lab0-03.png" alt=""></p>
<p><strong>é¢œè‰²ç¼–ç ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>red = 31
</span></span><span style="display:flex;"><span>green = 32
</span></span><span style="display:flex;"><span>yellow = 33
</span></span><span style="display:flex;"><span>blue = 34
</span></span><span style="display:flex;"><span>magenta = 35
</span></span><span style="display:flex;"><span>cyan = 36
</span></span><span style="display:flex;"><span>white = 37
</span></span></code></pre></div><h2 id="æ¸…å±">
  æ¸…å±
  <a href="#%e6%b8%85%e5%b1%8f" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>æœ‰æ—¶å€™ä½ å¯èƒ½æƒ³é€šè¿‡è¾“å…¥æŸæ¡å‘½ä»¤æ¥æ¸…å±ï¼Œæ¯”å¦‚hello&gt; clearï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ¥å£ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">linenoiseClearScreen</span>(<span style="color:#66d9ef">void</span>);
</span></span></code></pre></div><h2 id="å•è¡Œorå¤šè¡Œç¼–è¾‘">
  å•è¡Œorå¤šè¡Œç¼–è¾‘
  <a href="#%e5%8d%95%e8%a1%8cor%e5%a4%9a%e8%a1%8c%e7%bc%96%e8%be%91" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>é»˜è®¤æƒ…å†µä¸‹linenoiseä½¿ç”¨å•è¡Œç¼–è¾‘ï¼Œå¦‚æœéœ€è¦è¾“å…¥å¤§é‡å†…å®¹å¯ä»¥å¼€å¯å¤šè¡Œç¼–è¾‘æ¨¡å¼ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>linenoiseSetMultiLine(<span style="color:#ae81ff">1</span>);
</span></span></code></pre></div><p>å¼€å¯åï¼Œå¯ä»¥è¾“å…¥çš„æ•°æ®è¶…è¿‡å½“å‰è¡Œï¼š</p>
<p><img src="/images/15445/lab0-04.png" alt=""></p>
<p>å…³é—­åï¼Œä¸èƒ½è¶…è¿‡å½“å‰è¡Œï¼š</p>
<p><img src="/images/15445/lab0-05.png" alt=""></p>
<h2 id="å‘½ä»¤å†å²">
  å‘½ä»¤å†å²
  <a href="#%e5%91%bd%e4%bb%a4%e5%8e%86%e5%8f%b2" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>Linenoiseæ”¯æŒå†å²è®°å½•ï¼Œå› æ­¤ç”¨æˆ·ä¸å¿…ä¸€æ¬¡åˆä¸€æ¬¡åœ°é”®å…¥ç›¸åŒçš„å†…å®¹ï¼Œè€Œæ˜¯å¯ä»¥ä½¿ç”¨å‘ä¸‹å’Œå‘ä¸Šç®­å¤´æ¥æœç´¢å’Œé‡æ–°ç¼–è¾‘å·²ç»æ’å…¥çš„å‘½ä»¤ã€‚â€”â€”ä¸ªäººè§‰å¾—è¿™ä¸ªåŠŸèƒ½éå¸¸æœ‰ç”¨ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">// å°†ä¸€æ¡ä½ æ‰§è¡Œçš„å‘½ä»¤æ·»åŠ åˆ°å†å²ï¼Œä»è€Œä½ å¯ä»¥é€šè¿‡ä¸Šä¸‹é”®æ‰¾åˆ°å®ƒ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">linenoiseHistoryAdd</span>(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>line);
</span></span><span style="display:flex;"><span><span style="color:#75715e">// è¦ä½¿ç”¨å†å²è®°å½•ï¼Œæ‚¨å¿…é¡»è®¾ç½®å†å²è®°å½•çš„é•¿åº¦ï¼ˆé»˜è®¤æƒ…å†µä¸‹ä¸ºé›¶ï¼Œå› æ­¤ï¼Œå¦‚æœæœªè®¾ç½®æ­£ç¡®çš„é•¿åº¦ï¼Œåˆ™å°†ç¦ç”¨å†å²è®°å½•ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">linenoiseHistorySetMaxLen</span>(<span style="color:#66d9ef">int</span> len);
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Linenoiseç›´æ¥æ”¯æŒå°†å†å²è®°å½•ä¿å­˜åˆ°å†å²è®°å½•æ–‡ä»¶ä¸­ï¼Œé€šè¿‡ä¸‹é¢ä¸¤ä¸ªæ¥å£å¯ä»¥å­˜å–å†å²æ–‡ä»¶å†…å®¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">linenoiseHistorySave</span>(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>filename);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">linenoiseHistoryLoad</span>(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>filename);
</span></span></code></pre></div><p>ä¸‹é¢æ˜¯ä¸€æ®µèŒƒä¾‹ä»£ç </p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">while</span>((line <span style="color:#f92672">=</span> linenoise(<span style="color:#e6db74">&#34;hello&gt; &#34;</span>)) <span style="color:#f92672">!=</span> NULL) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/* Do something with the string. */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (line[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;\0&#39;</span> <span style="color:#f92672">&amp;&amp;</span> line[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;/&#39;</span>) {
</span></span><span style="display:flex;"><span>        printf(<span style="color:#e6db74">&#34;echo: &#39;%s&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, line);
</span></span><span style="display:flex;"><span>        linenoiseHistoryAdd(line); <span style="color:#75715e">/* Add to the history. */</span>
</span></span><span style="display:flex;"><span>        linenoiseHistorySave(<span style="color:#e6db74">&#34;history.txt&#34;</span>); <span style="color:#75715e">/* Save the history on disk. */</span>
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> <span style="color:#a6e22e">if</span> (<span style="color:#f92672">!</span>strncmp(line,<span style="color:#e6db74">&#34;/historylen&#34;</span>,<span style="color:#ae81ff">11</span>)) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* The &#34;/historylen&#34; command will change the history len. */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> len <span style="color:#f92672">=</span> atoi(line<span style="color:#f92672">+</span><span style="color:#ae81ff">11</span>);
</span></span><span style="display:flex;"><span>        linenoiseHistorySetMaxLen(len);
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> <span style="color:#a6e22e">if</span> (line[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;/&#39;</span>) {
</span></span><span style="display:flex;"><span>        printf(<span style="color:#e6db74">&#34;Unreconized command: %s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, line);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    free(line);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="bustubä¸­çš„ä½¿ç”¨">
  BusTubä¸­çš„ä½¿ç”¨
  <a href="#bustub%e4%b8%ad%e7%9a%84%e4%bd%bf%e7%94%a8" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>BusTubåªåœ¨<code>shell.cpp</code>ä¸­ä½¿ç”¨äº†è¯¥åº“ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>linenoiseHistorySetMaxLen(<span style="color:#ae81ff">1024</span>);
</span></span><span style="display:flex;"><span>linenoiseSetMultiLine(<span style="color:#ae81ff">1</span>);
</span></span></code></pre></div><p>è®¾ç½®å‘½ä»¤å†å²è®°å½•æœ€å¤§1024ï¼Œå¹¶å¼€å¯å¤šè¡Œè¾“å…¥ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>query_c_str <span style="color:#f92672">=</span> linenoise(line_prompt.c_str());
</span></span></code></pre></div><p>è·å–è¾“å…¥å­—ç¬¦ä¸²ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>query <span style="color:#f92672">+=</span> query_c_str
</span></span><span style="display:flex;"><span>linenoiseFree(query_c_str);
</span></span></code></pre></div><p>å°†æ”¶åˆ°çš„å­—ç¬¦ä¸²åŠ åˆ°<code>query</code>å˜é‡åï¼Œé‡Šæ”¾å­—ç¬¦ä¸²ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>linenoiseHistoryAdd(query.c_str());
</span></span></code></pre></div><p>å°†è¾“å…¥çš„å‘½ä»¤è®°å½•å†å²ã€‚</p>
<p>å‚è€ƒ:</p>
<p><a href="https://blog.csdn.net/whahu1989/article/details/125016151" target="_blank">https://blog.csdn.net/whahu1989/article/details/125016151</a>
</p>
<p><a href="https://segmentfault.com/a/1190000021643490" target="_blank">https://segmentfault.com/a/1190000021643490</a>
</p>
<p><a href="http://www.web-lovers.com/c-linenoise.html" target="_blank">http://www.web-lovers.com/c-linenoise.html</a>
</p>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h"
              >Read other posts</span
            >
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="https://yuyang.run/posts/%E5%B7%A5%E5%85%B7%E5%BA%93/libfort%E4%B8%AD%E6%96%87%E6%95%99%E7%A8%8B/">
                  <span class="button__icon">â†</span>
                  <span class="button__text">libfortä¸­æ–‡æ•™ç¨‹-ç¿»è¯‘</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="https://yuyang.run/posts/cmu15-445%E5%AE%9E%E9%AA%8C/lab2-hash-index/">
                  <span class="button__text">Lab2 Hash Index</span>
                  <span class="button__icon">â†’</span>
                </a>
              </span>
            
          </div>
        </div>
      
    

    
      
        

      
    
  </article>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <a
  href="https://yuyang.run"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >ä½™ä¸ºæ°‘åŒå¿—</span
    >
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
        <span>Â© 2024 Powered by <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a></span>
        <span><a href="https://github.com/panr/hugo-theme-hello-friend" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
    
  </div>
</footer>





<script type="text/javascript" src="/bundle.min.js"></script>


      
    </div>

    
  </body>
</html>
